(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[912],{2593:(e,n,t)=>{Promise.resolve().then(t.bind(t,1215))},1215:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>l});var a=t(2860),r=t(4836),s=t(2662),o=t(1084),i=t(4612),c=t.n(i);function l(){return(0,a.jsxs)("main",{className:"flex min-h-screen flex-col items-center p-8 sm:p-24",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold mb-6 text-center",children:"Anchor-Based Encoding"}),(0,a.jsx)("div",{className:"w-full max-w-4xl mb-8",children:(0,a.jsxs)(s.Zp,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center mb-6",children:[(0,a.jsx)("div",{className:"md:w-1/2 p-4",children:(0,a.jsx)(o.default,{src:"/images/pandas.png",alt:"Anchor-Based Encoding",width:400,height:300,className:"rounded-md"})}),(0,a.jsxs)("div",{className:"md:w-1/2 p-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-3",children:"Objective"}),(0,a.jsx)("p",{className:"mb-4",children:"Implement anchor-based encoding by labeling each patch location and anchor shape based on how well it matches the ground truth boxes."}),(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-3",children:"Setup"}),(0,a.jsxs)("ul",{className:"list-disc pl-5 mb-4",children:[(0,a.jsx)("li",{children:"Use predefined anchor shapes (e.g., [[1, 1], [2, 1], [1, 2]]) provided in a JSON file"}),(0,a.jsx)("li",{children:"At each patch center, generate anchor boxes based on the anchor shapes and patch size"})]})]})]}),(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-3",children:"Implementation Details"}),(0,a.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-md mb-6 overflow-auto",children:(0,a.jsx)("pre",{className:"text-sm",children:'def compute_iou(box1, box2):\n    """\n    Computes Intersection-over-Union (IoU) between two bounding boxes.\n    """\n    # Extract box coordinates\n    x1_center, y1_center, w1, h1 = box1\n    x2_center, y2_center, w2, h2 = box2\n    \n    # Calculate the half-widths and half-heights\n    half_w1, half_h1 = w1 / 2, h1 / 2\n    half_w2, half_h2 = w2 / 2, h2 / 2\n    \n    # Calculate the top-left and bottom-right corners of each box\n    x1_min, y1_min = x1_center - half_w1, y1_center - half_h1\n    x1_max, y1_max = x1_center + half_w1, y1_center + half_h1\n    \n    x2_min, y2_min = x2_center - half_w2, y2_center - half_h2\n    x2_max, y2_max = x2_center + half_w2, y2_center + half_h2\n    \n    # Calculate the intersection area\n    x_intersection = max(0, min(x1_max, x2_max) - max(x1_min, x2_min))\n    y_intersection = max(0, min(y1_max, y2_max) - max(y1_min, y2_min))\n    intersection_area = x_intersection * y_intersection\n    \n    # Calculate the union area\n    box1_area = w1 * h1\n    box2_area = w2 * h2\n    union_area = box1_area + box2_area - intersection_area\n    \n    # Calculate IoU\n    if union_area == 0:\n        return 0.0\n    \n    iou = intersection_area / union_area\n    return iou'})}),(0,a.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-md mb-6 overflow-auto",children:(0,a.jsx)("pre",{className:"text-sm",children:'def match_anchors_to_ground_truth(resized_boxes, grid, anchor_shape):\n    """\n    Matches anchors to ground truth boxes and generates supervision tensors.\n    """\n    # Initialize output tensors and best IoU tracker\n    existence = np.zeros((GRID_NUMBER, GRID_NUMBER, 2))\n    location = np.zeros((GRID_NUMBER, GRID_NUMBER, 4))\n    best_iou_map = np.zeros((GRID_NUMBER, GRID_NUMBER))\n    ws, hs = anchor_shape\n    \n    # Set all patches to background by default\n    existence[:, :, 1] = 1\n    \n    # Iterate through each ground truth box and patch grid cell\n    for gt in resized_boxes:\n        for i, j, x_center, y_center, _, _ in grid:\n            # Create anchor box with the specified shape at this patch center\n            anchor_w = PATCH_SIZE * ws\n            anchor_h = PATCH_SIZE * hs\n            anchor_box = [x_center, y_center, anchor_w, anchor_h]\n            \n            # Compute IoU between anchor and ground truth box\n            iou = compute_iou(anchor_box, gt)\n            \n            # If this anchor has better IoU than previous ones at this location\n            if iou > best_iou_map[j, i]:\n                best_iou_map[j, i] = iou\n                \n                # If there\'s any overlap (IoU > 0)\n                if iou > 0:\n                    # Mark as positive example\n                    existence[j, i, 0] = 1\n                    existence[j, i, 1] = 0\n                    \n                    # Calculate offsets (dx, dy, dw, dh) from anchor to ground truth\n                    gt_x, gt_y, gt_w, gt_h = gt\n                    \n                    # Encode the offsets\n                    dx = gt_x - x_center\n                    dy = gt_y - y_center\n                    dw = gt_w - anchor_w\n                    dh = gt_h - anchor_h\n                    \n                    # Store the offsets in the location tensor\n                    location[j, i] = [dx, dy, dw, dh]\n    \n    return existence, location'})}),(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-3",children:"Process"}),(0,a.jsxs)("ol",{className:"list-decimal pl-5 mb-6",children:[(0,a.jsxs)("li",{className:"mb-2",children:["For each image:",(0,a.jsxs)("ul",{className:"list-disc pl-5 mt-1",children:[(0,a.jsx)("li",{children:"Resize image and GT boxes to 200x200"}),(0,a.jsx)("li",{children:"Compute the patch grid (40x40 patches of size 5x5)"})]})]}),(0,a.jsxs)("li",{className:"mb-2",children:["For each anchor shape and each patch:",(0,a.jsxs)("ul",{className:"list-disc pl-5 mt-1",children:[(0,a.jsx)("li",{children:"Place an anchor box at the patch center"}),(0,a.jsx)("li",{children:"Compute IoU between the anchor and all GT boxes"}),(0,a.jsx)("li",{children:"Track the best IoU for each location"}),(0,a.jsxs)("li",{children:["If the current anchor has the best IoU and is greater than zero:",(0,a.jsxs)("ul",{className:"list-disc pl-5 mt-1",children:[(0,a.jsx)("li",{children:"Set Existence[row, col] = [1, 0]"}),(0,a.jsx)("li",{children:"Encode the GT box as offsets [dx, dy, dw, dh] from the anchor box"})]})]}),(0,a.jsx)("li",{children:"Otherwise, set Existence[row, col] = [0, 1]"})]})]})]}),(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-3",children:"Output"}),(0,a.jsx)("ul",{className:"list-disc pl-5 mb-6",children:(0,a.jsxs)("li",{children:["One pair of tensors per anchor shape per image:",(0,a.jsxs)("ul",{className:"list-disc pl-5 mt-1",children:[(0,a.jsx)("li",{children:"Existence tensor: (GRID_NUMBER, GRID_NUMBER, 2)"}),(0,a.jsx)("li",{children:"Location tensor: (GRID_NUMBER, GRID_NUMBER, 4)"})]})]})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(c(),{href:"/tensor-decoding",children:(0,a.jsx)(r.$,{variant:"outline",children:"Previous: Tensor Decoding"})}),(0,a.jsx)(c(),{href:"/anchor-decoding",children:(0,a.jsx)(r.$,{children:"Next: Anchor-Based Decoding"})})]})]})})]})}},4836:(e,n,t)=>{"use strict";t.d(n,{$:()=>l});var a=t(2860),r=t(3200),s=t(4933),o=t(1073),i=t(2979);let c=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=r.forwardRef((e,n)=>{let{className:t,variant:r,size:o,asChild:l=!1,...d}=e,h=l?s.DX:"button";return(0,a.jsx)(h,{className:(0,i.cn)(c({variant:r,size:o,className:t})),ref:n,...d})});l.displayName="Button"},2662:(e,n,t)=>{"use strict";t.d(n,{Zp:()=>o});var a=t(2860),r=t(3200),s=t(2979);let o=r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,className:(0,s.cn)("rounded-xl border bg-card text-card-foreground shadow",t),...r})});o.displayName="Card",r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",t),...r})}).displayName="CardHeader",r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,className:(0,s.cn)("font-semibold leading-none tracking-tight",t),...r})}).displayName="CardTitle",r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,className:(0,s.cn)("text-sm text-muted-foreground",t),...r})}).displayName="CardDescription",r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,className:(0,s.cn)("p-6 pt-0",t),...r})}).displayName="CardContent",r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,className:(0,s.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter"},2979:(e,n,t)=>{"use strict";t.d(n,{cn:()=>s});var a=t(9769),r=t(2460);function s(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return(0,r.QP)((0,a.$)(n))}}},e=>{var n=n=>e(e.s=n);e.O(0,[395,84,685,411,358],()=>n(2593)),_N_E=e.O()}]);